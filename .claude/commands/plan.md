---
description: 要件を明確化し、リスクを評価し、段階的な実装計画を作成。ユーザー確認を待ってからコードに着手。
---

# /plan コマンド

実装計画を作成するコマンド。コードを書く前に計画を立て、ユーザーの承認を得る。

## 実行内容

1. **要件の明確化** - 何を作るかを明確に
2. **リスクの特定** - 潜在的な問題点を洗い出し
3. **段階的計画** - 実装をフェーズに分割
4. **確認待ち** - ユーザーの明示的な承認を待つ

## 使用タイミング

- 新機能の開始時
- 大きなアーキテクチャ変更時
- 複雑なリファクタリング時
- 複数のファイル/コンポーネントに影響する時
- 要件が不明確/曖昧な時

## 計画フォーマット

```markdown
# 実装計画: [機能名]

## 要件の明確化
- [明確化した要件1]
- [明確化した要件2]

## 実装フェーズ

### フェーズ1: [名前]
- ファイル: path/to/file
- アクション: 具体的な作業内容
- 依存関係: なし / フェーズXが必要
- リスク: 低/中/高

### フェーズ2: [名前]
...

## 依存関係
- [依存1]
- [依存2]

## リスク
- HIGH: [説明]
- MEDIUM: [説明]
- LOW: [説明]

## 複雑度: 低/中/高

**確認待ち**: この計画で進めますか？ (yes/no/modify)
```

## 重要

**CRITICAL**: plannerエージェントはユーザーが明示的に「yes」「proceed」などで承認するまでコードを書きません。

変更が必要な場合:
- "modify: [変更内容]"
- "別のアプローチ: [代替案]"
- "フェーズ2を先にやって"

## PsyFit固有の考慮事項

計画時に必ず確認:
- 利用者向け/職員向けどちらの画面か
- セキュリティ要件（PII暗号化、監査ログ）
- アクセシビリティ要件（WCAG 2.1 AA）
- テスト要件（80%カバレッジ）

## 関連コマンド

- `/tdd` - TDDで実装
- `/code-review` - 実装をレビュー
- `/build-fix` - ビルドエラーを修正
