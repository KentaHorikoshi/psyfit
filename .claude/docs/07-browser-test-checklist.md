# ブラウザ動作テストチェックリスト

このドキュメントは、PsyFitアプリケーションのブラウザ上での動作テストを行う際のチェックリストです。

## 目次

1. [事前準備](#事前準備)
2. [利用者向けアプリ（U-01〜U-15）](#利用者向けアプリu-01u-15)
3. [職員向けアプリ（S-01〜S-09）](#職員向けアプリs-01s-09)
4. [画面遷移テスト](#画面遷移テスト)
5. [レスポンシブ・アクセシビリティテスト](#レスポンシブアクセシビリティテスト)
6. [セキュリティテスト](#セキュリティテスト)
7. [API連携テスト](#api連携テスト)

---

## 事前準備

### 環境起動

```bash
# 1. バックエンド (Rails API) - ポート4001
bin/rails server -b 0.0.0.0 -p 4001

# 2. フロントエンド (利用者向け) - ポート3000
cd frontend_user && npm run dev -- --host 0.0.0.0 --port 3000

# 3. フロントエンド (職員向け) - ポート3003
cd frontend_admin && npm run dev -- --host 0.0.0.0 --port 3003
```

### アクセスURL

| アプリ | URL |
|--------|-----|
| 利用者向け | http://localhost:3000 |
| 職員向け | http://localhost:3003 |
| バックエンドAPI | http://localhost:4001 |
| APIヘルスチェック | http://localhost:4001/api/v1/health |

### テストアカウント

| 種別 | ID/メール | パスワード |
|------|-----------|-----------|
| マネージャー | MGR001 | Manager1! |
| 職員 | STF001 | Staff123! |
| 職員 | STF002 | Staff123! |
| 利用者 | tanaka@example.com | Patient1! |
| 利用者 | takahashi@example.com | Patient1! |

### 事前チェック

- [ ] データベースが起動している
- [ ] Redisが起動している
- [ ] シードデータが投入されている (`bin/rails db:seed`)
- [ ] 各サーバーが正常に起動している
- [ ] APIヘルスチェックが200を返す

---

## 利用者向けアプリ（U-01〜U-15）

### U-01: ログイン画面

**URL**: http://localhost:3000/login

#### 基本機能

- [ ] メールアドレス入力フィールドが表示される
- [ ] パスワード入力フィールドが表示される
- [ ] ログインボタンが表示される
- [ ] パスワードリセットリンクが表示される

#### 正常系テスト

- [ ] 正しい認証情報でログインできる（tanaka@example.com / Patient1!）
- [ ] ログイン成功後、ウェルカム画面（U-10）に遷移する
- [ ] セッションCookieが設定される

#### 異常系テスト

- [ ] 空のメールアドレスでエラーが表示される
- [ ] 空のパスワードでエラーが表示される
- [ ] 不正なメールアドレス形式でエラーが表示される
- [ ] 存在しないアカウントでエラーが表示される
- [ ] 間違ったパスワードでエラーが表示される
- [ ] エラーメッセージが日本語で表示される

#### UI/UX

- [ ] フォントサイズが16px以上
- [ ] ボタンのタップ領域が44×44px以上
- [ ] Enterキーでフォーム送信できる
- [ ] パスワードフィールドがマスクされている

---

### U-02: トップ（ホーム）画面

**URL**: http://localhost:3000/home

#### 基本機能

- [ ] 3つのメインメニューが表示される
  - [ ] 「運動する」ボタン
  - [ ] 「記録する」ボタン
  - [ ] 「履歴を見る」ボタン
- [ ] 継続日数カードが表示される
- [ ] ユーザー名が表示される

#### ナビゲーション

- [ ] 「運動する」→ 運動メニュー選択画面（U-03）に遷移
- [ ] 「記録する」→ まとめて記録画面（U-15）に遷移
- [ ] 「履歴を見る」→ 履歴一覧画面（U-07）に遷移
- [ ] ログアウトボタンでログアウトできる

#### データ表示

- [ ] 継続日数が正しく表示される
- [ ] 本日の運動状況が表示される（実施済み/未実施）

---

### U-03: 運動メニュー選択画面

**URL**: http://localhost:3000/exercises

#### 基本機能

- [ ] 割り当てられた運動メニュー一覧が表示される
- [ ] 各運動のサムネイル/アイコンが表示される
- [ ] 運動名が表示される
- [ ] 本日の実施状況が表示される

#### ナビゲーション

- [ ] 運動カードをタップすると運動実施画面（U-04）に遷移
- [ ] 戻るボタンでホーム画面に戻る

#### データ

- [ ] APIから取得した運動メニューが表示される
- [ ] 実施済み運動にマークが付く

---

### U-04: 運動実施（動画）画面

**URL**: http://localhost:3000/exercises/:id/play

#### 基本機能

- [ ] 運動動画プレーヤーが表示される
- [ ] 再生/一時停止ボタンが機能する
- [ ] 動画が正常に再生される
- [ ] 回数・セット数カウンターが表示される
- [ ] 完了ボタンが表示される

#### 動画制御

- [ ] 動画の読み込み中にローディング表示
- [ ] 動画エラー時にエラーメッセージ表示
- [ ] シークバーで再生位置を変更できる
- [ ] 音量調整ができる（任意）

#### 運動記録

- [ ] 完了ボタンでAPI呼び出しが行われる
- [ ] 記録成功後、祝福画面（U-13）に遷移
- [ ] 記録失敗時にエラーメッセージ表示

---

### U-07: 履歴一覧画面

**URL**: http://localhost:3000/history

#### 基本機能

- [ ] 日付ごとの運動実施履歴が表示される
- [ ] カレンダー形式または一覧形式で表示
- [ ] 継続状況が視覚的にわかる

#### データ表示

- [ ] 実施した運動名が表示される
- [ ] 実施日時が表示される
- [ ] 期間フィルターが機能する（任意）

#### ナビゲーション

- [ ] 戻るボタンでホーム画面に戻る
- [ ] 詳細タップで詳細表示（任意）

---

### U-08: 測定値履歴画面

**URL**: http://localhost:3000/measurements

#### 基本機能

- [ ] 測定値の推移グラフが表示される（Recharts）
- [ ] 体重、筋力などの項目別表示
- [ ] 主観データ（痛み、調子）の表示

#### グラフ機能

- [ ] グラフが正常にレンダリングされる
- [ ] データポイントにホバーで詳細表示
- [ ] 期間切り替えが機能する

#### データ

- [ ] APIから取得したデータが表示される
- [ ] データがない場合の空状態表示

---

### U-09: パスワードリセット画面

**URL**: http://localhost:3000/password-reset

#### リセット申請

- [ ] メールアドレス入力フィールドが表示される
- [ ] 送信ボタンが表示される
- [ ] 有効なメールアドレスで送信成功メッセージ表示
- [ ] 存在しないメールでも成功メッセージ表示（セキュリティ）

#### パスワード設定

- [ ] リセットトークン付きURLで新パスワード設定画面表示
- [ ] 新パスワード入力フィールド
- [ ] 確認用パスワード入力フィールド
- [ ] パスワード複雑性チェック表示
- [ ] パスワード一致チェック表示
- [ ] 設定成功後ログイン画面に遷移

---

### U-10: ウェルカム画面

**URL**: http://localhost:3000/welcome

#### 基本機能

- [ ] 継続日数が大きく表示される
- [ ] モチベーション向上のメッセージ表示
- [ ] 3秒後に自動遷移する

#### インタラクション

- [ ] タップで即時遷移（自動遷移待たずに）
- [ ] 遷移先がホーム画面（U-02）

---

### U-11: 運動カード

**URL**: 運動メニュー選択画面内のコンポーネント

#### 基本機能

- [ ] 運動名が表示される
- [ ] サムネイル画像/アイコンが表示される
- [ ] 再生ボタンが表示される
- [ ] 実施状況バッジが表示される

#### インタラクション

- [ ] タップで運動実施画面に遷移
- [ ] ホバー時のビジュアルフィードバック

---

### U-13: 祝福画面

**URL**: http://localhost:3000/celebration

#### 基本機能

- [ ] 祝福メッセージが表示される
- [ ] クラッカーアニメーションが再生される
- [ ] 達成感を演出する視覚効果

#### 画面遷移

- [ ] 3秒後に体調入力画面（U-14）に自動遷移
- [ ] 「続ける」ボタンで即時遷移
- [ ] 遷移後の画面が正しい

---

### U-14: 体調入力画面

**URL**: http://localhost:3000/condition

#### 基本機能

- [ ] 痛みレベルスライダー（0-10）が表示される
- [ ] 身体の調子スライダー（0-10）が表示される
- [ ] 保存ボタンが表示される
- [ ] スキップボタンが表示される

#### スライダー機能

- [ ] スライダーがドラッグで動作する
- [ ] 現在値が数値で表示される
- [ ] タップで直接値設定可能

#### 保存機能

- [ ] 保存ボタンでAPI呼び出し
- [ ] 保存成功後ホーム画面に遷移
- [ ] スキップボタンで入力せずホーム画面に遷移

---

### U-15: まとめて記録画面

**URL**: http://localhost:3000/batch-record

#### 基本機能

- [ ] 未記録の運動一覧が表示される
- [ ] チェックボックス形式で複数選択可能
- [ ] 一括完了ボタンが表示される

#### 記録機能

- [ ] 複数運動を選択できる
- [ ] 全選択/全解除ボタン（任意）
- [ ] 一括記録でAPI呼び出し
- [ ] 記録成功後、適切な画面に遷移

---

## 職員向けアプリ（S-01〜S-09）

### 共通: サイドバー

#### 基本機能

- [ ] サイドバー背景色が#1E40AF
- [ ] ナビゲーションメニュー表示
  - [ ] ダッシュボード
  - [ ] 患者一覧
  - [ ] 職員管理（マネージャーのみ）
- [ ] 職員プロフィール表示
- [ ] ログアウトボタン

#### ロールベース表示

- [ ] 一般職員でログイン時、職員管理メニューが非表示
- [ ] マネージャーでログイン時、職員管理メニューが表示

---

### S-01: ログイン画面

**URL**: http://localhost:3003/login

#### 基本機能

- [ ] 職員ID入力フィールドが表示される
- [ ] パスワード入力フィールドが表示される
- [ ] ログインボタンが表示される

#### 正常系テスト

- [ ] マネージャーアカウントでログインできる（MGR001 / Manager1!）
- [ ] 一般職員アカウントでログインできる（STF001 / Staff123!）
- [ ] ログイン成功後、ダッシュボード（S-02）に遷移

#### 異常系テスト

- [ ] 空の職員IDでエラー表示
- [ ] 空のパスワードでエラー表示
- [ ] 存在しない職員IDでエラー表示
- [ ] 間違ったパスワードでエラー表示

---

### S-02: ダッシュボード

**URL**: http://localhost:3003/dashboard

#### 基本機能

- [ ] 担当患者一覧が表示される
- [ ] 本日の来院予定表示（任意）
- [ ] KPI表示
  - [ ] 担当患者数
  - [ ] 運動実施数
  - [ ] その他統計情報

#### データ更新

- [ ] リロードで最新データ取得
- [ ] 自動更新機能（任意）

---

### S-03: 患者一覧

**URL**: http://localhost:3003/patients

#### 基本機能

- [ ] 患者リストが表示される
- [ ] 患者名が表示される
- [ ] ステータスバッジが表示される
  - [ ] 急性期: 赤色（bg-red-100 / text-red-700）
  - [ ] 回復期: 黄色（bg-yellow-100 / text-yellow-700）
  - [ ] 維持期: 緑色（bg-green-100 / text-green-700）

#### 検索・フィルタ

- [ ] 患者名で検索できる
- [ ] カナで検索できる
- [ ] ステータスでフィルタできる

#### ページネーション

- [ ] ページネーションが機能する
- [ ] ページ数表示
- [ ] 前へ/次へボタン

#### 新規患者登録（マネージャーのみ）

- [ ] 「新規患者登録」ボタンが表示される（マネージャーのみ）
- [ ] 一般職員では非表示
- [ ] 登録ダイアログが開く
- [ ] 必須項目入力
  - [ ] 患者コード
  - [ ] 氏名
  - [ ] メールアドレス
  - [ ] 生年月日
  - [ ] 初期パスワード
- [ ] オプション項目入力
  - [ ] フリガナ
  - [ ] 性別
  - [ ] 電話番号
  - [ ] 病期
  - [ ] 疾患
- [ ] パスワード複雑性チェック表示
- [ ] 初期パスワード生成機能
- [ ] 登録成功時に初期パスワード表示
- [ ] 登録後一覧に反映

---

### S-04: 患者詳細

**URL**: http://localhost:3003/patients/:id

#### 基本機能

- [ ] 患者個人情報が表示される
- [ ] 疾患・身体状態が表示される
- [ ] 経過グラフが表示される

#### 関連機能へのナビゲーション

- [ ] 測定値入力（S-05）への遷移
- [ ] 運動メニュー設定（S-06）への遷移
- [ ] レポート出力（S-07）への遷移

---

### S-05: 測定値入力

**URL**: http://localhost:3003/patients/:id/measurements

#### 基本機能

- [ ] 測定日入力
- [ ] 膝伸展筋力入力
- [ ] TUG入力
- [ ] NRS入力
- [ ] MMT入力
- [ ] その他測定項目入力

#### バリデーション

- [ ] 必須項目チェック
- [ ] 数値範囲チェック
- [ ] 保存成功メッセージ表示
- [ ] 保存失敗時エラー表示

---

### S-06: 運動メニュー設定

**URL**: http://localhost:3003/patients/:id/exercises

#### 基本機能

- [ ] 利用可能な運動メニュー一覧表示
- [ ] 現在割り当て済みメニュー表示
- [ ] 疾患・状態に応じた推奨表示

#### 設定機能

- [ ] 運動メニューを追加できる
- [ ] 運動メニューを削除できる
- [ ] 設定保存でAPI呼び出し
- [ ] 保存成功メッセージ表示

---

### S-07: レポート出力

**URL**: http://localhost:3003/patients/:id/report

#### 基本機能

- [ ] 期間指定ができる
- [ ] レポートプレビュー表示
- [ ] PDF出力ボタン
- [ ] CSV出力ボタン

#### 出力機能

- [ ] PDFがダウンロードできる
- [ ] CSVがダウンロードできる
- [ ] ファイル名が適切

---

### S-08: 職員管理

**URL**: http://localhost:3003/staff

**アクセス制限**: マネージャーのみ

#### アクセス制御

- [ ] マネージャーでアクセス可能
- [ ] 一般職員でアクセスするとリダイレクトまたはエラー

#### 職員一覧

- [ ] 職員一覧が表示される
- [ ] 職員ID、氏名、役割が表示される

#### 新規職員登録

- [ ] 新規作成ダイアログ表示
- [ ] 職員ID入力
- [ ] 氏名入力
- [ ] 役割選択（一般/マネージャー）
- [ ] パスワード入力
- [ ] パスワード複雑性チェック表示
- [ ] 登録成功後一覧に反映

---

### S-09: パスワードリセット

**URL**: http://localhost:3003/password-reset

#### 基本機能

- [ ] 現在のパスワード入力
- [ ] 新しいパスワード入力
- [ ] 確認用パスワード入力

#### バリデーション

- [ ] 現在のパスワードが正しいかチェック
- [ ] パスワード複雑性チェック表示
  - [ ] 8文字以上
  - [ ] 2種類以上の文字
- [ ] パスワード一致チェック（リアルタイム）

#### 変更処理

- [ ] 変更成功時にログアウト
- [ ] ログイン画面へ自動遷移
- [ ] 変更失敗時エラー表示

---

## 画面遷移テスト

### 利用者向けフロー

#### ログイン〜運動実施フロー

```
ログイン(U-01) → ウェルカム(U-10) → ホーム(U-02) →
運動メニュー選択(U-03) → 運動実施(U-04) →
祝福(U-13) → 体調入力(U-14) → ホーム(U-02)
```

- [ ] 上記フローが正常に動作する
- [ ] 各遷移で適切なURLが設定される
- [ ] ブラウザの戻るボタンが適切に動作する

#### まとめて記録フロー

```
ホーム(U-02) → まとめて記録(U-15) → ホーム(U-02)
```

- [ ] 上記フローが正常に動作する

#### 履歴確認フロー

```
ホーム(U-02) → 履歴一覧(U-07)
ホーム(U-02) → 測定値履歴(U-08)
```

- [ ] 上記フローが正常に動作する

### 職員向けフロー

#### ログイン〜患者管理フロー

```
ログイン(S-01) → ダッシュボード(S-02) →
患者一覧(S-03) → 患者詳細(S-04) →
測定値入力(S-05) / 運動メニュー設定(S-06) / レポート出力(S-07)
```

- [ ] 上記フローが正常に動作する
- [ ] サイドバーナビゲーションが常に表示される

#### マネージャー専用フロー

```
ダッシュボード(S-02) → 職員管理(S-08)
患者一覧(S-03) → 新規患者登録
```

- [ ] 上記フローがマネージャーで動作する
- [ ] 一般職員ではアクセス不可

---

## レスポンシブ・アクセシビリティテスト

### 利用者向け（モバイルファースト）

#### ビューポートテスト

- [ ] iPhone SE (375px)で表示確認
- [ ] iPhone 12/13 (390px)で表示確認
- [ ] iPad (768px)で表示確認
- [ ] 横向きで表示確認

#### タッチ操作

- [ ] 全ボタンがタップ可能（44×44px以上）
- [ ] スライダーがスムーズに動作
- [ ] スワイプ操作が必要な箇所で正常動作

### 職員向け（PC/タブレット最適化）

#### ビューポートテスト

- [ ] iPad (768px)で表示確認
- [ ] iPad Pro (1024px)で表示確認
- [ ] デスクトップ (1280px)で表示確認
- [ ] 大画面 (1920px)で表示確認

#### サイドバー

- [ ] サイドバーが適切に表示される
- [ ] コンテンツ領域が適切に確保される

### アクセシビリティ

#### フォント

- [ ] 本文が16px以上
- [ ] 見出しが適切な階層構造

#### コントラスト

- [ ] テキストのコントラスト比4.5:1以上
- [ ] ボタンの視認性確認

#### キーボード操作

- [ ] Tabキーでフォーカス移動可能
- [ ] フォーカス状態が視覚的に明確
- [ ] Enterキーでアクション実行可能

#### スクリーンリーダー

- [ ] 適切なaria-label設定
- [ ] ボタンに適切なラベル
- [ ] フォームフィールドにラベル関連付け

---

## セキュリティテスト

### セッション管理

#### 利用者向け（タイムアウト: 30分）

- [ ] 30分無操作でセッション切れ
- [ ] セッション切れ後、ログイン画面にリダイレクト
- [ ] セッション切れ後、保護されたページにアクセス不可

#### 職員向け（タイムアウト: 15分）

- [ ] 15分無操作でセッション切れ
- [ ] セッション切れ後、ログイン画面にリダイレクト
- [ ] セッション切れ後、保護されたページにアクセス不可

### 認証・認可

- [ ] 未認証で保護されたページにアクセスするとリダイレクト
- [ ] 利用者アカウントで職員向けアプリにアクセス不可
- [ ] 職員アカウントで利用者向けアプリにアクセス不可
- [ ] 一般職員でマネージャー専用機能にアクセス不可

### アカウントロックアウト

- [ ] 5回連続ログイン失敗でアカウントロック
- [ ] ロック中はログイン不可
- [ ] 30分後に自動解除

### パスワードポリシー

- [ ] 8文字未満でエラー
- [ ] 1種類の文字のみでエラー
- [ ] 2種類以上の文字で成功

---

## API連携テスト

### 認証API

| エンドポイント | テスト項目 |
|---------------|-----------|
| POST /api/v1/auth/login | [ ] 正常ログイン |
| POST /api/v1/auth/staff/login | [ ] 職員ログイン |
| DELETE /api/v1/auth/logout | [ ] ログアウト |
| GET /api/v1/auth/me | [ ] 現在ユーザー取得 |

### 運動関連API

| エンドポイント | テスト項目 |
|---------------|-----------|
| GET /api/v1/users/me/exercises | [ ] 運動メニュー取得 |
| GET /api/v1/exercises/:id | [ ] 運動詳細取得 |
| POST /api/v1/exercise_records | [ ] 運動記録作成 |
| GET /api/v1/users/me/exercise_records | [ ] 運動履歴取得 |

### 体調・測定API

| エンドポイント | テスト項目 |
|---------------|-----------|
| POST /api/v1/daily_conditions | [ ] 体調記録作成 |
| GET /api/v1/users/me/daily_conditions | [ ] 体調履歴取得 |
| GET /api/v1/users/me/measurements | [ ] 測定値取得 |

### 患者管理API（職員向け）

| エンドポイント | テスト項目 |
|---------------|-----------|
| GET /api/v1/patients | [ ] 患者一覧取得 |
| GET /api/v1/patients/:id | [ ] 患者詳細取得 |
| POST /api/v1/patients | [ ] 患者登録 |
| PATCH /api/v1/patients/:id | [ ] 患者更新 |

### 動画配信API

| エンドポイント | テスト項目 |
|---------------|-----------|
| GET /api/v1/videos/:exercise_id/token | [ ] トークン取得 |
| GET /api/v1/videos/:exercise_id/stream | [ ] 動画ストリーム |

---

## テスト結果記録

### テスト実施情報

| 項目 | 内容 |
|------|------|
| テスト実施日 | |
| テスト実施者 | |
| ブラウザ | Chrome / Firefox / Safari / Edge |
| ブラウザバージョン | |
| OS | |
| デバイス | |

### 結果サマリー

| カテゴリ | 合格 | 不合格 | 未実施 | 備考 |
|---------|------|--------|--------|------|
| 利用者向けアプリ | | | | |
| 職員向けアプリ | | | | |
| 画面遷移 | | | | |
| レスポンシブ | | | | |
| アクセシビリティ | | | | |
| セキュリティ | | | | |
| API連携 | | | | |

### 不具合一覧

| No | 画面 | 内容 | 重大度 | ステータス |
|----|------|------|--------|-----------|
| 1 | | | | |
| 2 | | | | |
| 3 | | | | |

---

## 備考

- このチェックリストは基本設計書v4.1に基づいて作成
- テスト環境はローカル開発環境を想定
- 本番環境でのテストは別途実施が必要
- 自動テスト（Vitest, RSpec）と併用して品質を確保
